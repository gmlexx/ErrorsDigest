# coding: utf-8
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

documents = ["""Diadoc.TimeStampServer.Impl.SignatureService.SignatureService Diadoc.TimeStampServerHost Certificate is not trusted with suspicious reason UntrustedRoot, RevocationStatusUnknown, OfflineRevocation. Certificate: https://diadoc.kontur.ru/Certificate/Check?base64Cert=MIIF1TCCBYSgAwIBAgIKRDLDSQACAAIgrjAIBgYqhQMCAgMwgY4xHzAdBgkqhkiG9w0BCQEWEGNhQHNlcnR1bS1wcm8ucnUxCzAJBgNVBAYTAlJVMSEwHwYDVQQHDBjQldC60LDRgtC10YDQuNC90LHRg9GA0LMxIzAhBgNVBAoMGtCe0J7QniDQodC10YDRgtGD0Lwt0J%2FRgNC%2BMRYwFAYDVQQDEw1VQyBTZXJ0dW0tUHJvMB4XDTE0MDUxMzEwNDIwMFoXDTE1MDUxMzEwNDMwMFowggGeMRswGQYJKoZIhvcNAQkBFgxuY2NpQG5jY2kucnUxCzAJBgNVBAYTAlJVMSwwKgYDVQQIDCPQnNGD0YDQvNCw0L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjDEZMBcGA1UEBwwQ0JzRg9GA0LzQsNC90YHQujFOMEwGA1UECgxF0KHQtdCy0LXRgNC90LDRjyDRgtC%2B0YDQs9C%2B0LLQvi3Qv9GA0L7QvNGL0YjQu9C10L3QvdCw0Y8g0L%2FQsNC70LDRgtCwMT0wOwYDVQQDDDTQk9C70YPRiNC60L7QsiDQkNC90LDRgtC%2B0LvQuNC5INCc0LjRhdCw0LnQu9C%2B0LLQuNGHMT4wPAYJKoZIhvcNAQkCDC9JTk49NTE5MTExMDMwNy9LUFA9NTE5MDAxMDAxL09HUk49MTAyNTEwMDg1NjQ2MTEbMBkGA1UEDAwS0J%2FRgNC10LfQuNC00LXQvdGCMT0wOwYDVQQEDDTQk9C70YPRiNC60L7QsiDQkNC90LDRgtC%2B0LvQuNC5INCc0LjRhdCw0LnQu9C%2B0LLQuNGHMGMwHAYGKoUDAgITMBIGByqFAwICJAAGByqFAwICHgEDQwAEQB%2Bd1YP%2FvGRM1gM%2FH5vT69hHDJVyMqzdQPT9uCBzjkIXQCM80XqfRuYxAFTGX5y3H9tnFnHzMBhJv56jJYPjrEWjggKtMIICqTAOBgNVHQ8BAf8EBAMCBPAwfQYDVR0lBHYwdAYIKwYBBQUHAwIGCCsGAQUFBwMEBgcqhQMCAiIGBgcqhQMDgTkBBgcqhQMGAwEBBgcqhQMDBwVGBggqhQMGAwEDAQYIKoUDBgMBAgEGCCqFAwYDAQQBBggqhQMGAwEEAgYIKoUDBgMBBAMGCCqFAwMHAAEMMBcGA1UdEQQQMA6BDG5jY2lAbmNjaS5ydTAdBgNVHQ4EFgQUnUaHsfMsNL%2BFdcqrTfTxhYq8z9QwHwYDVR0jBBgwFoAUIcwsT2viDnPpwZYsxhcFs02CYpUwcwYDVR0fBGwwajA1oDOgMYYvaHR0cDovL2NhLnNlcnR1bS1wcm8ucnUvY2RwL3NlcnR1bS1wcm8tMjAxMy5jcmwwMaAvoC2GK2h0dHA6Ly9jYS5zZXJ0dW0ucnUvY2RwL3NlcnR1bS1wcm8tMjAxMy5jcmwwgZgGCCsGAQUFBwEBBIGLMIGIMEQGCCsGAQUFBzAChjhodHRwOi8vY2Euc2VydHVtLXByby5ydS9jZXJ0aWZpY2F0ZXMvc2VydHVtLXByby0yMDEzLmNydDBABggrBgEFBQcwAoY0aHR0cDovL2NhLnNlcnR1bS5ydS9jZXJ0aWZpY2F0ZXMvc2VydHVtLXByby0yMDEzLmNydDCBgQYHKoUDAgIxAgR2MHQwZBYyaHR0cDovL3NlcnR1bS5ydS9hYm91dC9kb2N1bWVudHMvY3J5cHRvcHJvLWxpY2Vuc2UMKtCh0JrQkSDQmtC%2B0L3RgtGD0YAg0Lgg0KHQtdGA0YLRg9C8LdCf0YDQvgMCBeAEDDgnub4x0m4a7OB%2B0TArBgNVHRAEJDAigA8yMDE0MDUxMzEwNDIwMFqBDzIwMTUwNTEzMTA0MjAwWjAIBgYqhQMCAgMDQQA5AXUrQaN34q2Wb695rnN4kEepXWHKzr7BlNV5R9Q5VB4SRdPOSbw5X8EA48JmSjDCPOCvBckdAYuDKdp9ESKa (null)"""]

tfidf_vectorizer = TfidfVectorizer(token_pattern=r'(?u)\b[a-zA-Z_\':,]+[\s(){}\[\]=.]', lowercase=False, use_idf=False)
tfidf_matrix = tfidf_vectorizer.fit(documents)

vectors = tfidf_matrix.transform(["""Diadoc.TimeStampServer.Impl.SignatureService.SignatureService Diadoc.TimeStampServerHost Some CA certificate in the chain is not valid for the reason UntrustedRoot. Certificate: https://diadoc.kontur.ru/Certificate/Check?base64Cert=MIIF1TCCBYSgAwIBAgIKRDLDSQACAAIgrjAIBgYqhQMCAgMwgY4xHzAdBgkqhkiG9w0BCQEWEGNhQHNlcnR1bS1wcm8ucnUxCzAJBgNVBAYTAlJVMSEwHwYDVQQHDBjQldC60LDRgtC10YDQuNC90LHRg9GA0LMxIzAhBgNVBAoMGtCe0J7QniDQodC10YDRgtGD0Lwt0J%2FRgNC%2BMRYwFAYDVQQDEw1VQyBTZXJ0dW0tUHJvMB4XDTE0MDUxMzEwNDIwMFoXDTE1MDUxMzEwNDMwMFowggGeMRswGQYJKoZIhvcNAQkBFgxuY2NpQG5jY2kucnUxCzAJBgNVBAYTAlJVMSwwKgYDVQQIDCPQnNGD0YDQvNCw0L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjDEZMBcGA1UEBwwQ0JzRg9GA0LzQsNC90YHQujFOMEwGA1UECgxF0KHQtdCy0LXRgNC90LDRjyDRgtC%2B0YDQs9C%2B0LLQvi3Qv9GA0L7QvNGL0YjQu9C10L3QvdCw0Y8g0L%2FQsNC70LDRgtCwMT0wOwYDVQQDDDTQk9C70YPRiNC60L7QsiDQkNC90LDRgtC%2B0LvQuNC5INCc0LjRhdCw0LnQu9C%2B0LLQuNGHMT4wPAYJKoZIhvcNAQkCDC9JTk49NTE5MTExMDMwNy9LUFA9NTE5MDAxMDAxL09HUk49MTAyNTEwMDg1NjQ2MTEbMBkGA1UEDAwS0J%2FRgNC10LfQuNC00LXQvdGCMT0wOwYDVQQEDDTQk9C70YPRiNC60L7QsiDQkNC90LDRgtC%2B0LvQuNC5INCc0LjRhdCw0LnQu9C%2B0LLQuNGHMGMwHAYGKoUDAgITMBIGByqFAwICJAAGByqFAwICHgEDQwAEQB%2Bd1YP%2FvGRM1gM%2FH5vT69hHDJVyMqzdQPT9uCBzjkIXQCM80XqfRuYxAFTGX5y3H9tnFnHzMBhJv56jJYPjrEWjggKtMIICqTAOBgNVHQ8BAf8EBAMCBPAwfQYDVR0lBHYwdAYIKwYBBQUHAwIGCCsGAQUFBwMEBgcqhQMCAiIGBgcqhQMDgTkBBgcqhQMGAwEBBgcqhQMDBwVGBggqhQMGAwEDAQYIKoUDBgMBAgEGCCqFAwYDAQQBBggqhQMGAwEEAgYIKoUDBgMBBAMGCCqFAwMHAAEMMBcGA1UdEQQQMA6BDG5jY2lAbmNjaS5ydTAdBgNVHQ4EFgQUnUaHsfMsNL%2BFdcqrTfTxhYq8z9QwHwYDVR0jBBgwFoAUIcwsT2viDnPpwZYsxhcFs02CYpUwcwYDVR0fBGwwajA1oDOgMYYvaHR0cDovL2NhLnNlcnR1bS1wcm8ucnUvY2RwL3NlcnR1bS1wcm8tMjAxMy5jcmwwMaAvoC2GK2h0dHA6Ly9jYS5zZXJ0dW0ucnUvY2RwL3NlcnR1bS1wcm8tMjAxMy5jcmwwgZgGCCsGAQUFBwEBBIGLMIGIMEQGCCsGAQUFBzAChjhodHRwOi8vY2Euc2VydHVtLXByby5ydS9jZXJ0aWZpY2F0ZXMvc2VydHVtLXByby0yMDEzLmNydDBABggrBgEFBQcwAoY0aHR0cDovL2NhLnNlcnR1bS5ydS9jZXJ0aWZpY2F0ZXMvc2VydHVtLXByby0yMDEzLmNydDCBgQYHKoUDAgIxAgR2MHQwZBYyaHR0cDovL3NlcnR1bS5ydS9hYm91dC9kb2N1bWVudHMvY3J5cHRvcHJvLWxpY2Vuc2UMKtCh0JrQkSDQmtC%2B0L3RgtGD0YAg0Lgg0KHQtdGA0YLRg9C8LdCf0YDQvgMCBeAEDDgnub4x0m4a7OB%2B0TArBgNVHRAEJDAigA8yMDE0MDUxMzEwNDIwMFqBDzIwMTUwNTEzMTA0MjAwWjAIBgYqhQMCAgMDQQA5AXUrQaN34q2Wb695rnN4kEepXWHKzr7BlNV5R9Q5VB4SRdPOSbw5X8EA48JmSjDCPOCvBckdAYuDKdp9ESKa (null)"""])

for s in cosine_similarity(tfidf_matrix.transform(documents), vectors):
    print s[0]

print tfidf_matrix.inverse_transform(tfidf_matrix.transform(documents))
print tfidf_matrix.inverse_transform(vectors)
